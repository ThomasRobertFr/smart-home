<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Watering</title>

    <link rel="manifest" href="manifest.json">

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/watering.css">
</head>
<body>

    <div class="container" role="main">
        <div class="page-header">
            <h1>Watering sensors</h1>
        </div>

        <table id="sensors" class="table table-hover">
            <thead>
                <!-- <tr id="sensors_headers_titles">
                    <th></th>
                    <th colspan="4" class="th-title"><span>Calibration</span></th>
                    <th colspan="9" class="th-title"><span>Watering</span></th>
                </tr>
                <tr id="sensors_headers">
                    <th data-key="id" data-type="str">ID</th>
                    <th data-key="calibrate" data-type="bool" data-show="icons-calibr">On?</th>
                    <th data-key="calibration_duration" data-type="int" data-append="s">Dur.</th>
                    <th data-key="calibration_min" data-type="int">Min</th>
                    <th data-key="calibration_max" data-type="int">Max</th>
                    <th data-key="watering" data-type="bool" data-show="icons-water">On?</th>
                    <th data-special="measures">Humidity</th>
                    <th data-key="watering_last_delta"  data-special="waterings" data-type="int" data-show="h_min" data-append=" ago">Watered</th>
                    <th data-key="watering_humidity_threshold" data-type="int" data-append="%">Thresh</th>
                    <th data-key="watering_humidity_target" data-type="int" data-append="%">Target</th>
                    <th data-key="watering_cycle_nb_max" data-type="int" data-append="×">Nb</th>
                    <th data-key="watering_cycle_duration" data-type="int" data-append="s">Dur.</th>
                    <th data-key="watering_cycle_sleep" data-type="int" data-append="s">Sleep</th>
                    <th data-key="watering_cooldown" data-type="int" data-show="h_min">Cooldown</th>
                    <th data-key="measure_interval" data-type="int" data-show="h_min">Sleep</th>
                    <th data-special="buttons">Actions</th>
                </tr>-->
                <tr id="sensors_headers_titles">
                    <th data-key="id" data-type="str">ID</th>
                    <th class="th-title"><span>Calibration</span></th>
                    <th class="th-title"><span>Humidity</span></th>
                    <th class="th-title"><span>Watering</span></th>
                    <th colspan="2" class="th-title"><span>Watering setup</span></th>
                    <th><button type="button" class="btn btn-default btn-xs btn-edit">
                            <i class="fad fa-pencil" aria-hidden="true"></i></button></th>
                </tr>
                <tr id="sensor-pattern" class="hide sensor" data-id="{id}">
                    <td>{id}</td>
                    <td>{sensor_exist,icons-sensor} <span class="{sensor_exist,class_hide_if_false}">{calibrate,icons-calibr} {calibration_duration}s <small>({calibration_min}&mdash;{calibration_max})</small></span></td>
                    <td>
                        <div class="{sensor_exist,class_hide_if_false}">
                        <span class="sparkline" id="sparkline-{id}"></span>
                        {all,humidity_last_val,%} <small>({measures,humidity_last_time, ago}, refresh {measure_interval,h_min})</small>
                        </div>
                    </td>
                    <td>{watering,icons-water} Last {watering_last_delta,h_min} ago <small>({waterings,waterings_last_val}×)</small></td>
                    <td>{watering_scheduled,icons-sched}
                        <span class="{watering_scheduled,class_hide_if_true}">
                            &lt; {watering_humidity_threshold}% ↗ {watering_humidity_target}%
                        </span>
                        <span class="{watering_scheduled,class_hide_if_false}">
                            {watering_scheduling_start_bound,h}-{watering_scheduling_end_bound,h}
                        </span>
                    </td>
                    <td>{watering_cycle_nb_max} × ({watering_cycle_duration}s + {watering_cycle_sleep}s pause), every {watering_cooldown,h_min} max</td>
                    <td>
                        <button type="button" class="btn btn-danger btn-xs btn-remove">
                            <i class="fad fa-trash" aria-hidden="true"></i></button>
                    </td>
                </tr>
            <!--
            <tr id="pattern" class="sensor" data-id="cuisineG">
                <td>cuisineG</td>
                <td colspan="4"><i class="fad fa-compass-slash" aria-hidden="true"></i> 20s <small>(262&mdash;693)</small></td>
                <td colspan="2"><span class="sparkline" id="sparkline-cuisineG"></span>93% <small>(1 min ago, refresh 1h)</small></td>
                <td><i class="fad fa-tint-slash" aria-hidden="true"></i> Last 13h17 ago <small>(30×)</small></td>
                <td colspan="2">&lt; 45% ↗ 80%</td>
                <td colspan="5">10 × (8s + 5s pause), every 3h max</td><td><button type="button" class="btn btn-primary btn-xs btn-show"><i class="fad fa-chart-line" aria-hidden="true"></i></button> <button type="button" class="btn btn-default btn-xs btn-edit"><i class="fad fa-pencil" aria-hidden="true"></i></button> <button type="button" class="btn btn-danger btn-xs btn-remove"><i class="fad fa-trash" aria-hidden="true"></i></button></td>
            </tr>
            -->
            </thead>
            <tbody>
            </tbody>
        </table>

        <h3>Add a sensor</h3>
        <form class="form-inline" id="form_add" action="/api/devices/watering/">
            <div class="form-group">
                <input type="text" class="form-control" id="new_id" placeholder="New sensor ID">
          </div>
          <button type="submit" class="btn btn-default">Add sensor</button>
        </form>

    </div>

    <script src="js/jquery-3.1.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/apexcharts.min.js"></script>
    <script src="js/watering.js"></script>
    <script src="js/fontawesome.min.js"></script>
</body>
</html>
